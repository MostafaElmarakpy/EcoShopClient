<div class="modal-header">
  <h5 class="modal-title">{{ mode === 'edit' ? 'Edit Product' : 'Add Product' }}</h5>
  <button type="button" class="btn-close" aria-label="Close" (click)="cancel()"></button>
</div>

<div class="modal-body">
  <form [formGroup]="form">
    <div class="mb-2">
      <label class="form-label">Name</label>
      <input class="form-control" formControlName="name" />
    </div>

    <div class="mb-2">
      <label class="form-label">Code</label>
      <input class="form-control" formControlName="productCode" />
    </div>

    <div class="row g-2 mb-2">
      <div class="col">
        <label class="form-label">Price</label>
        <input type="number" class="form-control" formControlName="price" />
      </div>
      <div class="col">
        <label class="form-label">Category ID</label>
        <input class="form-control" formControlName="categoryId" />
      </div>
    </div>

    <div class="mb-2">
      <label class="form-label">Images</label>
      <input type="file" (change)="onFilesChange($event)" class="form-control" accept="image/*" />
    </div>

    <div class="row">
      <div class="col-md-3 mb-2" *ngIf="preview">
        <div class="card">
          <img [src]="preview" class="card-img-top" />
          <div class="card-body p-2">
            <button type="button" class="btn btn-sm btn-danger w-100" (click)="removePreview()">Remove</button>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="existingImages.length > 0">
      <h6 class="mt-2">Existing Images</h6>
      <div class="row">
        <div class="col-md-3 mb-2" *ngFor="let img of existingImages; let i = index">
          <div class="card">
            <img [src]="img" class="card-img-top" />
            <div class="card-body p-2">
              <button type="button" class="btn btn-sm btn-danger w-100" (click)="removeExisting(i)">Remove</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="progress > 0" class="progress mt-2">
      <div class="progress-bar" [style.width.%]="progress">{{ progress }}%</div>
    </div>

  </form>
</div>

<div class="modal-footer">
  <button class="btn btn-secondary" (click)="cancel()">Cancel</button>
  <button class="btn btn-primary" (click)="save()" [disabled]="form.invalid">Save</button>
</div>
